<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>AI learning 2：SVM Algorithm - 进击的程序媛，Laker&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="google-site-verification" content="BxWqqPVkmU3CTQmmIjCp27ZjmcXuB_YTf8Xa7lp_G-w" />
  <meta name="keywords" content="Algorithm,人工智能,AI,ML,DL">
<meta property="og:type" content="article">
<meta property="og:title" content="AI learning 2：SVM Algorithm">
<meta property="og:url" content="http://laker.me/blog/2018/11/01/18_1101_ai_svm/index.html">
<meta property="og:site_name" content="进击的程序媛，Laker&#39;s blog">
<meta property="og:image" content="http://wx4.sinaimg.cn/large/6d184cefly1fwylhut942j20p00463yw.jpg">
<meta property="og:updated_time" content="2018-11-07T00:55:08.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="AI learning 2：SVM Algorithm">
<meta name="twitter:image" content="http://wx4.sinaimg.cn/large/6d184cefly1fwylhut942j20p00463yw.jpg">
  
    <link rel="alternative" href="true" title="进击的程序媛，Laker&#39;s blog" type="application/atom+xml">
  
  
    <!--link rel="icon" href="/favicon.png"-->
    <link href="/blog/favicon.ico" rel="icon" type="image/x-ico">
  
  <!-- <link href="/blog/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/blog/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css"> -->
  <link href="/blog/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
  <link href="/blog/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/blog/css/style.css">
  <!--% if (theme.google_analytics){ %-->
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

// ga('create', 'null', 'auto');
ga('create', 'UA-43961506-2', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->
<!--% } %-->

  
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?c84935c1bc2fcf0a3f6a741737cccf7d";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</head>
<body>
  <div id="container">
    <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-inner" class="inner">
      <a id="main-nav-toggle" class="nav-icon"></a>
      <!-- <a id="logo" class="logo" href="/blog/"></a> -->
      <a id="logo" class="logo" href="http://laker.me"></a>
      <nav id="main-nav">
        
          <a class="main-nav-link" href="/blog/">Home</a>
        
          <a class="main-nav-link" href="/blog/archives">Archives</a>
        
          <a class="main-nav-link" href="/blog/projects">Projects</a>
        
          <a class="main-nav-link" href="/blog/about">About</a>
        
          <a class="main-nav-link" href="/blog/categories">Categories</a>
        
          <a class="main-nav-link" href="/blog/blogrolls">Blogrolls</a>
        
          <a class="main-nav-link" href="/blog/atom.xml">RSS</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://laker.me/blog"></form>
        </div>
      </nav>
    </div>
  </div>
  <!-- Fork me on github -->
  <!-- <a href="https://github.com/younglaker" target="_blank" title="Fork me on GitHub"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a> -->

  <!-- Fork me on Github, Github Logo -->
  <a href="https://github.com/younglaker" class="github-corner" target="_blank" title="Fork me on GitHub"><svg width="60" height="60" viewBox="0 0 250 250" style="fill:#333;color:#fff;position:absolute;top:0;border:0;right:0"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
</header>
    <section id="main" class="outer"><article id="post-18_1101_ai_svm" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      AI learning 2：SVM Algorithm
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/blog/2018/11/01/18_1101_ai_svm/" class="article-date">
  <time datetime="2018-11-01T00:24:00.000Z" itemprop="datePublished">2018-11-01</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/blog/categories/AI/">AI</a>
  </div>

      
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="http://wx4.sinaimg.cn/large/6d184cefly1fwylhut942j20p00463yw.jpg" alt="AI learning 2：SVM Algorithm"></p>
<a id="more"></a>
<blockquote>
<p>Exchange blogroll： <a href="http://laker.me/blog">laker.me</a><br>Github：<a href="https://github.com/younglaker" target="_blank" rel="external">https://github.com/younglaker</a></p>
</blockquote>
<h2 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h2><p>Environment: </p>
<ul>
<li>Anacoda Navigator</li>
<li>python 3.6</li>
</ul>
<p>Python packages(all in Anacoda, don’t have to install extractly):</p>
<ul>
<li><a href="http://www.numpy.org/" target="_blank" rel="external">numpy</a>: for scientific computing</li>
<li><a href="https://pandas.pydata.org/" target="_blank" rel="external">pandas</a>: for data analysis</li>
<li><a href="http://scikit-learn.org/stable/" target="_blank" rel="external">sklearn</a>: Simple and efficient tools for data mining and data analysis</li>
</ul>
<p>Code and datas <a href="https://pan.baidu.com/s/1wX3rXqWvjlnCFRk6yyXznQ" target="_blank" rel="external">https://pan.baidu.com/s/1wX3rXqWvjlnCFRk6yyXznQ</a></p>
<h2 id="Coding"><a href="#Coding" class="headerlink" title="Coding"></a>Coding</h2><p>Import packages and set alias.</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"># <span class="keyword">import</span> SVC <span class="keyword">in</span> svm <span class="keyword">module</span></div><div class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC </div><div class="line">#<span class="keyword">import</span> train_test_split <span class="keyword">in</span> model_selection <span class="keyword">module</span></div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</div></pre></td></tr></table></figure>
<p>Import training file <code>16.MNIST.train.csv</code>, it’s a matrix of a picture. The first column is type of then row.<br>The number means grayscale value of the picture pixel.<br>And we only use the last 5000 rows to train.</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># inputData <span class="keyword">is</span> <span class="keyword">object</span> <span class="keyword">of</span> pandas, <span class="keyword">and</span> use pandas <span class="function"><span class="keyword">function</span>  <span class="title">iloc</span> <span class="title">to</span> <span class="title">select</span> <span class="title">the</span> <span class="title">last</span> 5000 <span class="title">rows</span>.</span></div><div class="line"></div><div class="line"><span class="title">inputData</span> = <span class="title">pd</span>.<span class="title">read_csv</span><span class="params">(<span class="string">'./16.MNIST.train.csv'</span>)</span></div><div class="line"><span class="title">inputData</span> = <span class="title">inputData</span>.<span class="title">iloc</span>[-5000:, :]</div></pre></td></tr></table></figure>
<p>============== Usage of pandas function iloc ==============<br><a href="https://www.shanelynn.ie/select-pandas-dataframe-rows-and-columns-using-iloc-loc-and-ix/" target="_blank" rel="external">https://www.shanelynn.ie/select-pandas-dataframe-rows-and-columns-using-iloc-loc-and-ix/</a><br>There are two “arguments” to iloc – a row selector, and a column selector. </p>
<p><code>data.iloc[rows, columns]</code></p>
<p><code>data.iloc[a:b, c:d]</code> means from row a to row b, column c to column d.</p>
<p><code>data.iloc[a:, :d]</code> means from row a to column end, column one to column d.</p>
<p>Single selections using iloc and DataFrame</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># Rows:</span></div><div class="line"><span class="class"><span class="keyword">data</span>.iloc[0] # first row of <span class="keyword">data</span> frame - <span class="type">Note</span> a <span class="type">Series</span> <span class="keyword">data</span> <span class="keyword">type</span> output.</span></div><div class="line"><span class="class"><span class="keyword">data</span>.iloc[1] # second row of <span class="keyword">data</span> frame </span></div><div class="line"><span class="class"><span class="keyword">data</span>.iloc[-1] # last row of <span class="keyword">data</span> frame </span></div><div class="line"></div><div class="line"><span class="meta"># Columns:</span></div><div class="line"><span class="class"><span class="keyword">data</span>.iloc[:,0] # first column of <span class="keyword">data</span> frame </span></div><div class="line"><span class="class"><span class="keyword">data</span>.iloc[:,1] # second column of <span class="keyword">data</span> frame </span></div><div class="line"><span class="class"><span class="keyword">data</span>.iloc[:,-1] # last column of <span class="keyword">data</span> frame</span></div></pre></td></tr></table></figure>
<p>Multiple columns and rows can be selected together using the .iloc indexer.</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">data.iloc[<span class="number">0</span>:<span class="number">5</span>] # <span class="keyword">first</span> five rows of dataframe</div><div class="line">data.iloc[:, <span class="number">0</span>:<span class="number">2</span>] # <span class="keyword">first</span> two columns of data frame with <span class="keyword">all</span> rows</div><div class="line">data.iloc[[<span class="number">0</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">24</span>], [<span class="number">0</span>,<span class="number">5</span>,<span class="number">6</span>]] # <span class="number">1</span><span class="keyword">st</span>, <span class="number">4</span><span class="keyword">th</span>, <span class="number">7</span><span class="keyword">th</span>, <span class="number">25</span><span class="keyword">th</span> row + <span class="number">1</span><span class="keyword">st</span> <span class="number">6</span><span class="keyword">th</span> <span class="number">7</span><span class="keyword">th</span> columns.</div><div class="line">data.iloc[<span class="number">0</span>:<span class="number">5</span>, <span class="number">5</span>:<span class="number">8</span>] # <span class="keyword">first</span> <span class="number">5</span> rows <span class="built_in">and</span> <span class="number">5</span><span class="keyword">th</span>, <span class="number">6</span><span class="keyword">th</span>, <span class="number">7</span><span class="keyword">th</span> columns of data frame</div></pre></td></tr></table></figure>
<blockquote>
<p>Python list <a href="https://www.w3schools.com/python/python_lists.asp" target="_blank" rel="external">https://www.w3schools.com/python/python_lists.asp</a></p>
</blockquote>
<p>============== / End Usage of pandas function iloc ==============</p>
<p>In the taining data, the first colums is lable, so we drop label column using <code>drop([&#39;label&#39;], 1)</code>, extract it to parameter ‘label’ using <code>inputData[&#39;label&#39;]</code>, and convert it to array using <code>np.array()</code>.<br><figure class="highlight maxima"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">data = <span class="built_in">np</span>.<span class="built_in">array</span>(inputData.drop(['<span class="built_in">label</span>'], <span class="number">1</span>))</div><div class="line"><span class="built_in">label</span> = <span class="built_in">np</span>.<span class="built_in">array</span>(inputData['<span class="built_in">label</span>'])</div></pre></td></tr></table></figure></p>
<p>============== Usage of pandas function drop ==============<br><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.drop.html" target="_blank" rel="external">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.drop.html</a><br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; df = pd.DataFrame(np.arange(<span class="number">12</span>).reshape(<span class="number">3</span>,<span class="number">4</span>),</div><div class="line">...                   columns=['A', 'B', 'C', 'D'])</div><div class="line">&gt;&gt;&gt; df</div><div class="line">   A  B   C   D</div><div class="line"><span class="number">0</span>  <span class="number">0</span>  <span class="number">1</span>   <span class="number">2</span>   <span class="number">3</span></div><div class="line"><span class="number">1</span>  <span class="number">4</span>  <span class="number">5</span>   <span class="number">6</span>   <span class="number">7</span></div><div class="line"><span class="number">2</span>  <span class="number">8</span>  <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></div></pre></td></tr></table></figure></p>
<p>Drop columns</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#</span><span class="bash"> axis : &#123;0 or ‘index’, 1 or ‘columns’&#125;, default 0</span></div><div class="line"><span class="meta">&gt;</span><span class="bash">&gt;&gt; df.drop([<span class="string">'B'</span>, <span class="string">'C'</span>], axis=1)</span></div><div class="line">   A   D</div><div class="line">0  0   3</div><div class="line">1  4   7</div><div class="line">2  8  11</div></pre></td></tr></table></figure>
<p>or:</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; df.drop(columns=['B', 'C'])</div><div class="line">   A   D</div><div class="line"><span class="number">0</span>  <span class="number">0</span>   <span class="number">3</span></div><div class="line"><span class="number">1</span>  <span class="number">4</span>   <span class="number">7</span></div><div class="line"><span class="number">2</span>  <span class="number">8</span>  <span class="number">11</span></div></pre></td></tr></table></figure>
<p>Drop a row by index<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; df.drop([<span class="number">0</span>, <span class="number">1</span>])</div><div class="line">   A  B   C   D</div><div class="line"><span class="number">2</span>  <span class="number">8</span>  <span class="number">9</span>  <span class="number">10</span>  <span class="number">11</span></div></pre></td></tr></table></figure></p>
<p>============== / End Usage of pandas function drop ==============</p>
<p>============== Usage of numpy function array ==============<br><a href="https://docs.scipy.org/doc/numpy-1.15.1/reference/generated/numpy.array.html" target="_blank" rel="external">https://docs.scipy.org/doc/numpy-1.15.1/reference/generated/numpy.array.html</a></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; np.array(<span class="string">[[1, 2], [3, 4]]</span>)</div><div class="line">array(<span class="string">[[1, 2],</span></div><div class="line">       [3, 4]])</div></pre></td></tr></table></figure>
<p>============== / End Usage of numpy function array ==============</p>
<p>Then deal with the data, it’s a little tricky. Set data which is smaller than 100 to 0, and which is bigger than 100 to 1.</p>
<figure class="highlight haskell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta"># Improve accuracy from 0.1 to 0.9</span></div><div class="line"><span class="class"><span class="keyword">data</span>[<span class="keyword">data</span>&lt;=100] = 0</span></div><div class="line"><span class="class"><span class="keyword">data</span>[<span class="keyword">data</span>&gt;100] = 1</span></div></pre></td></tr></table></figure>
<p>Extract the first 5 rows.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">inputData</span><span class="selector-class">.head</span>()</div></pre></td></tr></table></figure>
<p>============== Usage of pandas function iloc ==============<br><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.head.html" target="_blank" rel="external">https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.head.html</a></p>
<blockquote>
<p>DataFrame.head(n)</p>
</blockquote>
<p>Return the first n rows, default n=5.</p>
<p>This function returns the first n rows for the object based on position. It is useful for quickly testing if your object has the right type of data in it.</p>
<p>See also</p>
<blockquote>
<p>DataFrame.tail(n)</p>
</blockquote>
<p>Returns the last n rows.</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;</span>&gt; df = pd.DataFrame(&#123;<span class="string">'animal'</span><span class="symbol">:</span>[<span class="string">'alligator'</span>, <span class="string">'bee'</span>, <span class="string">'falcon'</span>, <span class="string">'lion'</span>,</div><div class="line">...                    <span class="string">'monkey'</span>, <span class="string">'parrot'</span>, <span class="string">'shark'</span>, <span class="string">'whale'</span>, <span class="string">'zebra'</span>]&#125;)</div><div class="line"><span class="meta">&gt;&gt;</span>&gt; df</div><div class="line">      animal</div><div class="line"><span class="number">0</span>  alligator</div><div class="line"><span class="number">1</span>        bee</div><div class="line"><span class="number">2</span>     falcon</div><div class="line"><span class="number">3</span>       lion</div><div class="line"><span class="number">4</span>     monkey</div><div class="line"><span class="number">5</span>     parrot</div><div class="line"><span class="number">6</span>      shark</div><div class="line"><span class="number">7</span>      whale</div><div class="line"><span class="number">8</span>      zebra</div></pre></td></tr></table></figure>
<p>Viewing the first n lines (three in this case)<br><figure class="highlight lsl"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&gt;&gt;&gt; df.head(<span class="number">3</span>)</div><div class="line">      animal</div><div class="line"><span class="number">0</span>  alligator</div><div class="line"><span class="number">1</span>        bee</div><div class="line"><span class="number">2</span>     falcon</div></pre></td></tr></table></figure></p>
<p>============== /End Usage of pandas function iloc ==============</p>
<p>Use 70% data to train and 30% to test the taining result using <code>test_size=0.3</code>. Here we don’t specify the train_size, and it will automatically set to the complement of the test size, which is 1-0.3=0.7.</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data_train, data_test, label_train, <span class="attr">label_test</span> = train_test_split(data, label, <span class="attr">test_size=0.3,</span> <span class="attr">random_state=87)</span></div></pre></td></tr></table></figure>
<p>======= Usage of sklearn.model_selection.train_test_split =======<br><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" target="_blank" rel="external">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html</a></p>
<p><code>train_test_split(*arrays, **options)</code> </p>
<p>Split arrays or matrices into random train and test subsets</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</div></pre></td></tr></table></figure>
<p><strong>Parameters:</strong></p>
<ul>
<li><p>*arrays : sequence of indexables with same length / shape[0]<br>Allowed inputs are lists, numpy arrays, scipy-sparse matrices or pandas dataframes.</p>
</li>
<li><p>test_size : float, int or None, optional (default=0.25)<br>If float, should be between 0.0 and 1.0 and represent the proportion of the dataset to include in the test split. If int, represents the absolute number of test samples. If None, the value is set to the complement of the train size. By default, the value is set to 0.25. </p>
</li>
<li><p>train_size : float, int, or None, (default=None)<br>If float, should be between 0.0 and 1.0 and represent the proportion of the dataset to include in the train split. If int, represents the absolute number of train samples. If None, the value is automatically set to the complement of the test size.</p>
</li>
<li><p>random_state : int, RandomState instance or None, optional (default=None)<br>If int, random_state is the seed used by the random number generator; If RandomState instance, random_state is the random number generator; If None, the random number generator is the RandomState instance used by np.random.</p>
</li>
<li><p>shuffle : boolean, optional (default=True)<br>Whether or not to shuffle the data before splitting. If shuffle=False then stratify must be None.</p>
</li>
<li><p>stratify : array-like or None (default=None)<br>If not None, data is split in a stratified fashion, using this as the class labels.</p>
</li>
</ul>
<p><strong>Returns:</strong>  </p>
<ul>
<li>splitting : list, length=2 * len(arrays)<br>List containing train-test split of inputs.</li>
</ul>
<p>======= /End Usage of sklearn.model_selection.train_test_split =======</p>
<p>Use SVC model and <code>fit()</code> to train, set more parameters in SVC() improve accuracy:</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">SVM_model = SVC()</div><div class="line">SVM_model.fit(data_train, label_train)</div></pre></td></tr></table></figure>
<p>======= Usage of sklearn.model_selection.train_test_split =======</p>
<p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html" target="_blank" rel="external">http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html</a></p>
<blockquote>
<p>SVC(C=1.0, kernel=’rbf’, degree=3, gamma=’auto_deprecated’, coef0=0.0, shrinking=True, probability=False, tol=0.001, cache_size=200, class_weight=None, verbose=False, max_iter=-1, decision_function_shape=’ovr’, random_state=None)</p>
</blockquote>
<p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC.fit" target="_blank" rel="external">http://scikit-learn.org/stable/modules/generated/sklearn.svm.SVC.html#sklearn.svm.SVC.fit</a></p>
<blockquote>
<p>fit(X, y, sample_weight=None)</p>
</blockquote>
<p>Fit the SVM model according to the given training data.</p>
<p>======= /End Usage of sklearn.model_selection.train_test_split =======</p>
<p>Use the first 10 rows to test and get the predict result. Then compare the predict result and label to score a point.</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">SVM_model</span><span class="selector-class">.predict</span>(<span class="selector-tag">data_test</span><span class="selector-attr">[:10]</span>)</div><div class="line"></div><div class="line"><span class="selector-tag">label_test</span><span class="selector-attr">[:10]</span></div><div class="line"></div><div class="line"><span class="selector-tag">SVM_model</span><span class="selector-class">.score</span>(<span class="selector-tag">data_test</span>, <span class="selector-tag">label_test</span>)</div></pre></td></tr></table></figure>
<p>We can write a <code>score()</code> fuction like this instead of using <code>score()</code>.</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">correct = 0</div><div class="line">prediction = SVM_model.<span class="keyword">predict</span>(data_test)</div><div class="line"><span class="keyword">for</span> i, <span class="keyword">lab</span> <span class="keyword">in</span> enumerate(label_test):</div><div class="line">    # <span class="keyword">if</span> prediction == <span class="keyword">label</span>, correct+1</div><div class="line">    <span class="keyword">if</span> prediction[i] == <span class="keyword">lab</span>:  </div><div class="line">        correct += 1</div><div class="line"></div><div class="line"># accuracy = correct numbers / all <span class="keyword">test</span> numbers</div><div class="line">accuracy = correct / len(label_test)</div><div class="line"><span class="keyword">print</span>(<span class="string">"Accuracy is:"</span>, accuracy)</div></pre></td></tr></table></figure>

        <hr>
        <div class="copyrights1">
          <a href="http://laker.me/blog/2018/11/01/18_1101_ai_svm/">AI learning 2：SVM Algorithm</a>
          <!--%- partial('post/title', {class_name: 'archive-article-title'}) %-->
          <p>本文原创自<a href="http://laker.me/blog">http://laker.me/blog</a>，转载请注明出处，欢迎交换友链</p>
          <p>如果本文对您有帮助，微信扫一扫，请我吃个鸡腿吧</p>
          <p><img src="http://wx2.sinaimg.cn/large/6d184cefly1fw014hlsn1j2046046gly.jpg"></p>
        </div>
      
    </div>
  
    <footer class="article-footer">
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/AI/">AI</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/Algorithm/">Algorithm</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/DL/">DL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/ML/">ML</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/人工智能/">人工智能</a></li></ul>

    </footer>
  
  <p class="hint-text hidden">阅读量<span id="busuanzi_value_page_pv"></span>次</p>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/blog/2018/11/14/18_1113_tencent_cloud/" id="article-nav-newer" class="article-nav-link-wrap">
      <div class="article-nav-title"><span>&lt;</span>&nbsp;
        
          First step in Tencent Cloud and Baota Panel
        
      </div>
    </a>
  
  
    <a href="/blog/2018/10/04/18_1004_anaconda/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">AI 学习1	：Anaconda 配置&nbsp;<span>&gt;</span></div>
    </a>
  
</nav>

  
</article>





<section id="comment">
  <h1 class="title">评论组件不稳定，有事请联系V信 lakerHQ (请备注来自博客)</h1>
  <div id="disqus_thread">
    <!-- UY BEGIN -->
    <div id="uyan_frame"></div>
    <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1672779"></script>
    <!-- UY END -->
  </div>
</section>

</section>
    <footer id="footer">
  
  <div class="outer">
    <!--div id="footer-info" class="inner">
      &copy; 2018 Laker Huang&nbsp;
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>, theme by <a href="http://github.com/ppoffice">PPOffice</a>
    </div-->
    <div id="footer-info" class="inner">
      &copy; 2014 - 2018 Laker Huang&nbsp; <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" /></a>
    </div>
    <p class="hint-text">自2015/11/04，本站共被抚摸 <span id="busuanzi_value_site_pv"></span> 次</p>
    <p class="hint-text">您是第 <span id="busuanzi_value_site_uv"></span> 位小伙伴</p>
  </div>
</footer>
    

<!--script src="/blog/js/jquery.min.js"></script-->
<script src="https://cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script>
<!-- <script src="https://cdn.bootcss.com/jquery.lazyload/1.9.1/jquery.lazyload.min.js"></script> -->



<script src="/blog/js/script.js"></script>

<div id="totop" style="position:fixed;bottom:100px;right:50px;cursor: pointer;">
	<a title="返回顶部"><img src="/blog/img/scrollup.png"/></a>
</div>
<script src="/blog/js/totop.js"></script>


<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
  </div>

</body>
</html>